function bindings(){setAboutHeights(),setSectionHeights(),logWindowWidth(),$(window).on("resize",function(){setAboutHeights(),setSectionHeights(),logWindowWidth()}),$(".nav-closer").on("click",function(){Nav.toggle()}),$(".menu-toggle").on("click",function(a){Nav.toggle(),a.preventDefault()}),$positions.on("click","> div",function(a){$(this).addClass("active");var b=$(this).data("position");Modernizr.history?history.pushState({},"","#!/positions/"+b):window.location.hash="#!/positions/"+b,ga("send","pageview","/"+window.location.hash),$overlayContent=$(this).find(".detail"),showPosition(),a.preventDefault()}),$(".expand").on("click",function(){$(this).hasClass("open")&&$("#chapters .part1").height()-$(".expand").height()+20,$(this).toggleClass("open"),$(this).siblings(".part2").toggleClass("open")}),$("body").on("swipe",".wrapper",function(a){var b=a.direction;if($(window).innerWidth()>480){if("right"===b)return Nav.open(),!1;if("left"===b)return Nav.close(),!1}}),$("body").on("click","#legal",function(a){Odelay.open($(".legal").html()),a.preventDefault()})}function load(){console.log("load"),$body.addClass("loading"),Odelay.close(!0),Nav.close(),$(window).off("touchmove"),window.location.hash.indexOf("#!/")>-1?ga("send","pageview","/"+window.location.hash):ga("send","pageview","/")}function routes(){routie({"":function(){load(),loadAbout()},"!":function(){load(),loadAbout()},"!/":function(){load(),loadAbout()},"!/about":function(){load(),loadAbout()},"!/positions":function(){loadPositions()},"!/positions/":function(){load(),loadPositions()},"!/positions/:position":function(a){load(),loadPositions("positions",a)},"!/chapters/":function(){load(),loadPositions()},"!/chapters/:cancerType":function(a){load(),loadPositions("chapters",a)},"!/support":function(){load(),loadSupport()},"!/support/ebook":function(){load(),loadEBook()},"!/support/posters":function(){load(),loadPosters()}})}function loadAbout(){load(),$about.show(),$body.removeClass("loading positions support").addClass("about"),$(window).on("touchmove",!1),setTimeout(function(){$("section").not("#about").hide(),window.scrollTo(0,0),$("nav").removeClass("open"),$(".menu-toggle").removeClass("active"),clearFilters()},400),0===$("#about svg").length&&loadAboutAnimations(),$("#about > div").onScreen({direction:"vertical",doIn:function(){var a=$(this).attr("id");animateThisSVG(aboutAnimations,a),$(this).index()},tolerance:200,throttle:500,toggleClass:"onScreen"}),$("#about").on("click",".about-navigation img",function(){var a=$(this).attr("id");if("next"===a){var b=parseFloat($("#about").attr("data-scroll-status"))+1;$("#about > div").eq(b)&&$("#about > div").eq(b).scrollToAnchor(),$("#about").attr("data-is-scrolling",!0),setTimeout(function(){$("#about").attr("data-is-scrolling",!1),$("#about").attr("data-scroll-status",b)},600)}if("prev"===a){var b=parseFloat($("#about").attr("data-scroll-status"))-1;$("#about > div").eq(b)&&$("#about > div").eq(b).scrollToAnchor(),$("#about").attr("data-is-scrolling",!0),setTimeout(function(){$("#about").attr("data-is-scrolling",!1),$("#about").attr("data-scroll-status",b)},600)}}),$("body").on("swipe","#about[data-is-scrolling=false]",function(a){var b=a.direction;return"down"===b?($("#about .onScreen #prev").click(),!1):"up"===b?($("#about .onScreen #next").click(),!1):void 0})}function loadPositions(a,b){load(),$positions.hasClass("empty")?loadPositionsJSON(a,b):loadPositionsState(a,b),$positionsContainer.show(),$("#positions").width(),setPositionSize(),$(window).on("resize",function(){setPositionSize()}),setTimeout(function(){$("section").not("#positions-container").hide(),window.scrollTo(0,0)},400),$body.removeClass("loading about support").addClass("positions")}function loadPositionsState(a,b){var c=new WOW;c.init(),void 0!=a?"positions"===a?setTimeout(function(){$overlayContent=$positions.find('[data-position="'+b+'"]').find(".detail"),showPosition()},500):"chapters"===a?b&&setTimeout(function(){filters(b)},500):(clearFilters(),Odelay.close()):(clearFilters(),Odelay.close())}function setPositionSize(){containerWidth=$("#positions").width(),$("#positions > div").css({width:containerWidth/2-10,height:containerWidth/2-10}),$("#positions > div.position-full-size.position-vertical").css("height",containerWidth),$("#positions > div.position-full-size.position-horizontal").css("width",containerWidth)}function loadSupport(){load(),$support.show(),$body.removeClass("loading about positions").addClass("support"),$(window).height()>768&&$(".store-item-wrapper").matchHeight(),$(window).on("resize",function(){$(window).height()>768?$(".store-item-wrapper").matchHeight():$(".store-item-wrapper").attr("style","")}),$("body").on("click",".store-item-ebook",function(){routie("#!/support/ebook")}),$("body").on("click",".store-item-posters",function(){routie("#!/support/posters")}),setTimeout(function(){$("section").not("#support").hide(),clearFilters(),window.scrollTo(0,0)},400)}function loadEBook(){load(),$ebook.show(),$body.removeClass("loading about positions support posters").addClass("ebook"),$(window).height()>768&&$(".ebook .row > div").matchHeight(),$(window).on("resize",function(){$(window).height()>768?$(".ebook .row > div").matchHeight():$(".ebook .row > div").attr("style","")}),setTimeout(function(){$("section").not("#ebook").hide(),clearFilters(),window.scrollTo(0,0)},400)}function loadPosters(){load(),$posters.show(),$body.removeClass("loading about positions support ebook").addClass("posters"),setTimeout(function(){$("section").not("#posters").hide(),clearFilters(),window.scrollTo(0,0)},400),$(".return-to-cancer-sutra").on("click",function(){$(this).closest("form").find("input[type=text], textarea").val(""),$(".form-thank-you").hide()})}var $wrapper,$all,$about,$positions,$positionsContainer,$support,$ebook,$filters,$container,$loader,$body,$overlay,$overlayContent,$posters,containerWidth,windowWidth;$(function(){$body=$("body"),$wrapper=$(".wrapper"),$about=$("#about"),$positions=$("#positions"),$support=$("#support"),$positionsContainer=$("#positions-container"),$ebook=$("#ebook"),$posters=$("#posters"),$all=$("section"),$filters=$(".filter a"),$container=$(".container"),$loader=$(".loader"),$overlay=$(".overlay"),bindings(),imagesLoaded("body",routes)});